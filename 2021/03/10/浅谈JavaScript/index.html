<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-xxxxxx-xx"></script>
  <script type="text/javascript">
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-xxxxxx-xx');
  </script>
  

  <!-- Baidu Tongji -->
  
  <script type="text/javascript">
    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  

  <!-- Baidu Push -->
  
  <script>
    (function() {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>
  

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc" />
  <meta name="baidu-site-verification" content="PpzM9WxOJU" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="It&#39;s an IT blog..." />
  <meta name="keyword" content="Bubba,IT  blog,Blog" />
  <link rel="shortcut icon" href="/img/avatar/roguerabbit.jpg" />

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>
  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/beantech.min.css" />

  <!-- Pygments Highlight CSS -->
  
<link rel="stylesheet" href="../../../../css/highlight.css">
<link rel="stylesheet" href="../../../../css/widget.css">
<link rel="stylesheet" href="../../../../css/rocket.css">
<link rel="stylesheet" href="../../../../css/signature.css">
<link rel="stylesheet" href="../../../../css/catalog.css">
<link rel="stylesheet" href="../../../../css/livemylife.css">


  
  <!-- wave start -->
  <link rel="stylesheet" href="/css/wave.css" />
  <!-- wave end -->
  

  
  <!-- top start (article top hot config) -->
  <link rel="stylesheet" href="/css/top.css" />
  <!-- top end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/css/scroll.css" />
  <!-- ThemeColor end -->
  

  
  <!-- viewer start (Picture preview) -->
  <link rel="stylesheet" href="/css/viewer.min.css" />
  <!-- viewer end -->
  

  
  <!-- Search start -->
  <link rel="stylesheet" href="/css/search.css" />
  <!-- Search end -->
  

  
  <!-- ThemeColor start -->
  <link rel="stylesheet" href="/css/themecolor.css" />
  <!-- ThemeColor end -->
  

  

  
  <!-- gitalk start -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
  <link rel="stylesheet" href="/css/gitalk.css" />
  <!-- gitalk end -->
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
    href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="http://yoursite-url/2021/03/10/浅谈JavaScript/">
  <title>
    
    浅谈JavaScript - Welcome you to Bubba&#39;s life
    
  </title>
<meta name="generator" content="Hexo 4.2.1"></head>


<!-- hack iOS CSS :active style -->

<body ontouchstart="" class="body--home">
	<!-- ThemeColor -->
	
	<!-- ThemeColor -->
<!-- <div class="toggle" onclick="document.body.classList.toggle('body--dark')">Switch Color</div> -->

<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons bright-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>

	

	<!-- Gitter -->
	
	<!-- Gitter -->
<!-- Docs:https://gitter.im/?utm_source=left-menu-logo -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'your-community/your-room'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

	

	<!-- Navigation (contains search)-->
	<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Enjoy the life</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">Home</a>
          </li>

          

          
          

          
          <li>
            <a href="/archive/">Archives</a>
          </li>
          
          

          
          <li>
            <a href="/categories/">Categories</a>
          </li>
          
          

          
          <li>
            <a href="/about/">About</a>
          </li>
          
          

          
          <li>
            <a href="/tags/">Tags</a>
          </li>
          
          

          
          <li><a class="popup-trigger" title="Search"><span class="search-icon"></span>Search</a></li>
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>


<script>
  // Drop Bootstarp low-performance Navbar
  // Use customize navbar with high-quality material design animation
  // in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


	<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    header.intro-header {
       /*post*/
        background-image: url('');
      
    }

    
      #signature {/*signature*/
        background-image: url('/undefined');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#JS" title="JS">JS</a>
              
            </div>
            <h1>浅谈JavaScript</h1>
            <h2 class="subheading"></h2>
            <span class="meta">
              Posted by Bubba on
              2021-03-10
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">23</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">6k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- 不蒜子统计 start -->
            <span class="meta">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            <!-- WordCount end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



	<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
	<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <p>最近工作中接触到JavaScript相关项目，作为一名JS初学者，通过项目与学习获得了JS的一些知识，借着这篇文章，分享一下这段时间了解到的内容。</p>
<p>在开始之前，让我们先思考以下几个问题：</p>
<ul>
<li>JavaScript以Java为前缀，两种编程语言之间有什么关联？</li>
<li>JS能够帮助前端开发者解决什么问题？</li>
<li>市场上有各种各样的浏览器，怎么能够保证同一段JS代码在不同浏览器都可以执行成功呢？</li>
<li>JS能够操作网页内容，开发者是否可以通过恶意JS代码入侵用户电脑？</li>
<li>在Java中，需要定义数据类型，而在JS中却不用显式申明变量数据类型，在这背后的原理是什么？</li>
<li>JS中关键字Class与Java中的Class含义是相同的么？</li>
<li>在JS中经常用到的回调函数是什么？作用是什么？</li>
</ul>
<p>本文分为以下两部分，围绕上面这些问题展开描述；</p>
<ul>
<li>发展背景</li>
<li>语言特性（包含基础语法以及JS特性）</li>
</ul>
<h1 id="发展背景"><a href="#发展背景" class="headerlink" title="发展背景"></a>发展背景</h1><p>JavaScript的产生依赖于浏览器的发展，<strong>让我们把时间拨回到1993年，第一个世界公认的浏览器在美国NCSA诞生了，名称为Mosaic，</strong>当时受到了人们的欢迎；然而1994年的时候，Mosaic的竞争对手Netscape出现了，Netscape开发的浏览器取其名为Mozilla（Mosaic killer的简称），并且为了能够攻破Mosaic的垄断地位，首先提出了通过脚本语言操作网页元素的想法，这样使网页看起来更生动流畅，创新理念及新技术的应用使得Mozilla越来越受欢迎；至于这种脚本语言为什么被命名为JavaScript(以下简称JS)，该名称也是由于Netscape和Sun公司合作后，当时Java是被广大开发者和市场熟知的，为了博得市场的欢迎，名称中引入了Java前缀；<strong>在1995年Netscape完成了JavaScript的初版</strong>，Netscape是开创者，一石激起千层浪，互联网巨头微软为了能够赢得市场上浏览器的份额，紧随Netscape的脚步，开发了可以在 Internet explorer浏览器运行的脚本语言取名为JScript，再加上CEnvi（Nombas公司发明的） 中的 ScriptEase，至此三个版本的Script互相竞争，长期来看，这三种版本Script的语法规范与运行环境有差异，带来的后果是同一脚本在不同浏览器上表现不一致，开发者需要依赖于浏览器的运行环境定制脚本，广大开发者及浏览器用户难以忍受这种现状，那接下来发生了什么事情呢？</p>
<p>经过了野蛮生长的浏览器脚本语言，Netscape想通过统一JS规范结束上述困境，在欧洲计算机制造商协(ECMA  European Computer Manufactures Association)的帮助下，定制了JS脚本语言规范，<strong>1997年的时候确立了JavaScript标准</strong>，命名为ECMAScript(以下简称ES)，这个标准的作用在于它明确了一种编程语言的特性、语法、类型、功能和 API 等实现标准，那么对于各家浏览器厂商而言，在支持ES规范的基础上，可以选择各自的实现方式，比如Chrome中的V8（JS）、Firefox中的SpiderMonkey(C++/C)以及IE的Chakra(JScript)。对开发者的好处是，统一了平台兼容问题，只需要按照ECMAScript中的标准来实现需求，不需要考虑浏览器间的兼容问题。</p>
<p>在前人的不懈努力下，至此ES统一了JavaScript的标准，2000年之后JS的发展有三个变革点：</p>
<ul>
<li>Ajax(Asynchronous JavaScript And XML) - 异步的与服务器交互，动态的修改页面元素；</li>
<li>Node -  告别了JS只能作用于前端的时代，将JS引入了服务器后端领域；</li>
<li>ES6 - 2015年ES6的推出，给JS带来了新的特性，更加适合熟悉传统编程语言的开发者，奠定了Morden Java Script的基础。</li>
</ul>
<p>从<a href="https://en.wikipedia.org/wiki/ECMAScript" target="_blank" rel="noopener">wiki</a>上可以看到，二十多年来ECMAScript在不断的完善和成长，现如今，<a href="https://262.ecma-international.org/6.0/" target="_blank" rel="noopener">ES6</a>进入了广大开发者的视野，JS成为了近几年最受欢迎的编程语言，在这曲折而又充满惊喜的发展道路上，启发我们的不仅仅是新技术的涌现与实践，更多的是敢于创新的精神值得去学习。</p>
<p>这一节有三点需要说明一下：</p>
<ul>
<li>JS设计初衷是为了让页面更生动，可以动态操作网页元素，JS不能够独立发挥作用，需要结合BOM（Browser Object Model）和DOM（Document Object Model）对象，感兴趣的查看一下<a href="https://juejin.cn/post/6844903939008102413" target="_blank" rel="noopener">这三者的关系</a>;</li>
<li>ES定义了JS的语言规范，随着技术的不断改进，ES的标准也在不断的更新，在<a href="https://262.ecma-international.org/6.0/" target="_blank" rel="noopener">这里</a>可以看到最新的规范；</li>
<li>JS不仅可以运行在浏览器端的JS引擎中，还可以运行在装有Node环境的机器上，在后端服务器中也看到JS的身影。</li>
</ul>
<p>这张图可以帮助大家更好的了解JS的发展历史：</p>
<p><img src="JSHistory.png" alt="JS发展历史"></p>
<p>相信大家对JS发展路径有了初步的认识，接下来聊一下JS这门语言特性。</p>
<h1 id="JavaScript语言特性"><a href="#JavaScript语言特性" class="headerlink" title="JavaScript语言特性"></a>JavaScript语言特性</h1><p>首先我们来看一下来自<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/About_JavaScript" target="_blank" rel="noopener">MDN</a>对JS的定义：</p>
<blockquote>
<p>JavaScript® (often shortened to JS) is a lightweight, interpreted, object-oriented language with first-class functions, and is best known as the scripting language for Web pages, but it’s used in many non-browser environments as well. It is a prototype-based, multi-paradigm scripting language that is dynamic, and supports object-oriented, imperative, and functional programming styles.</p>
</blockquote>
<p>下面我们理解一下这四个关键字：</p>
<ol>
<li>轻量级（lightweight） -  理解为这门脚本为弱类型语言，上手容易，功能强大；</li>
<li>解释型（Interpreted） - 作为脚本语言，只需要JS引擎解释运行，没有编译步骤；</li>
<li>面向对象（object-oriented language with first-class functions）- 相对于面向过程，具备抽象封装、继承、多态的特征，其中包含头等函数，意味着函数可以作为函数的参数、函数的返回值，可以赋值给变量或存储在数据结构中，包含了<a href="https://zh.wikipedia.org/wiki/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B" target="_blank" rel="noopener">函数式编程</a>的思维；</li>
<li>基于原型（prototype-based）- 简单可以理解为基于实例的编程，没有Java中类的概念，像Java属于基于类编程，感兴趣的可以参考一下<a href="https://zh.wikipedia.org/wiki/%E5%9F%BA%E4%BA%8E%E5%8E%9F%E5%9E%8B%E7%BC%96%E7%A8%8B" target="_blank" rel="noopener">wiki</a>，在<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Details_of_the_Object_Model#Class-Based_vs._Prototype-Based_Languages" target="_blank" rel="noopener">MDN</a>有比较两者的区别。</li>
</ol>
<p>JS可以帮助开发者做哪些事情呢？</p>
<p>其实在浏览器端JS活动范围是有限的，它不能访问CPU、内存等底层系统，所以是一门用户安全的编程语言，不存在有恶意脚本攻击用户电脑的情况。在活动范围内，JS大概可以做下面三类事情：</p>
<ul>
<li>调用DOM接口，修改网页元素，为网页添加丰富的动态功能，为用户提供流畅美观的网页；</li>
<li>用户交互，响应用户的行为，比如点击按钮、输入字符串、鼠标移动等事件；</li>
<li>处理前端用户请求，与服务器交互，异步请求服务器资源。</li>
</ul>
<p>到现在为止，以上是关于JS的特性和作用描述，下面通过常用数据类型、事件和函数、异步特性这三方面帮助大家进一步认识JS。</p>
<h2 id="常用数据类型"><a href="#常用数据类型" class="headerlink" title="常用数据类型"></a>常用数据类型</h2><p>与大部分编程语言类似，JS支持基本数据类型和引用数据类型，两者的区别在于<strong>值是否存在于堆区（heap）</strong>,如下图所示：</p>
<p><img src="JSMemoryModel.png" alt="JS内存分配模型"></p>
<p>可以看到JS内存空间分配有两部分组成：</p>
<ul>
<li>栈区（stack） - 有序排列，大小固定</li>
<li>堆区（heap） - 无序排列，大小不固定</li>
</ul>
<p>其中对于基本数据类型，变量地址和值都会放到栈区，比如<em>let num = 1</em>这句申明，变量名num会与栈区分配的地址绑定，并且num的值1也会放到栈区中，这样做的好处也是为了方便存储和提升访问效率，JS为开发者提供了<a href="https://javascript.info/types" target="_blank" rel="noopener">7种基本数据类型</a>：string、number、bigint、 boolean、symbol、null、underfined；</p>
<p>基本数据类型不能满足开发者的所有需要，更多的时候需要操作对象，也就是引用类型，先看一个例子，比如<em>let array=[1,2]</em>，首先我们申明了一个array变量，这个变量与栈区（stack）绑定的地址存放的是一个指针，这个指针是堆区(heap)的地址，具体array的值存在堆区中，意味着引用类型的栈区（stack）存放了指向堆区（heap）的内存地址，引用类型的值存放在堆区空间中，常用的引用类型包含：Object、Function、Array等。</p>
<p>这两种不同的存储方式影响到变量的初始化、赋值和数据传递：</p>
<ol>
<li>数据初始化</li>
</ol>
<p>JS中初始化数据不需要指定数据类型，比如同样定义一个字符串类型的变量：<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Java</span></span><br><span class="line"><span class="built_in">String</span> s = <span class="string">"Java"</span>;</span><br><span class="line"><span class="comment">//JS</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="string">'javascript'</span>;</span><br></pre></td></tr></table></figure><br><strong>原因在于JS是在被解析器执行阶段才能分析确定数据类型</strong>，意味着JS是一门弱类型语言，在编写代码定义变量阶段不需要申明类型；</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"hello world"</span>;<span class="comment">//String</span></span><br><span class="line"><span class="keyword">let</span> n = <span class="number">123</span>; <span class="comment">//Number</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="literal">true</span>; <span class="comment">//Boolean</span></span><br></pre></td></tr></table></figure>
<p>在ES6之前，只需要一个<strong>var</strong>关键字即可，由于var关键字的作用域是function级别的，不支持block级别(只要代码中一对大括号{}，意味着是一个block)，会导致以下变量污染问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myVar = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> myVar = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(myVar);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(myVar); <span class="comment">//Output 2, Expected 1</span></span><br></pre></td></tr></table></figure>

<p>在ES6中除了支持var，还支持以下let、const关键字：</p>
<p><img src="JSSupportedkeyword.png" alt="JS支持的关键字"></p>
<p>这三者的区别在于作用域和值是否可被修改，let和const都是block级别的，执行上面同样的代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myVar = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">   <span class="keyword">let</span> myVar = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(myVar);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(myVar); <span class="comment">//Output 1, Expected 1</span></span><br></pre></td></tr></table></figure>

<p>再看一下变量的可修改性，其中var和let是可被多次修改赋值，const申明的是常量，注意如果const申明的是一个引用类型，对象内的属性仍然是可以被修改，比如下面的代码可以正常运行：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const ANIMAL = &#123;name : <span class="string">"cat"</span>&#125;;</span><br><span class="line">console.log(<span class="module-access"><span class="module"><span class="identifier">ANIMAL</span>.</span></span>name); <span class="comment">//Output cat</span></span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">ANIMAL</span>.</span></span>name = <span class="string">"dog"</span>;</span><br><span class="line">console.log(<span class="module-access"><span class="module"><span class="identifier">ANIMAL</span>.</span></span>name); <span class="comment">//Output dog</span></span><br></pre></td></tr></table></figure>
<p>对于基本数据类型，初始化变量在栈区完成；对于引用数据类型，初始化变量需要在栈区和堆区完成。</p>
<ol start="2">
<li>数据赋值</li>
</ol>
<p>数据初始化完成后，经常会被别的变量引用，比如现在有A、B两个变量，A变量已经完成了初始化，<em>B=A</em>完成了将A赋值给B的过程，问题在于B值的变化会引起A的变化么？搞清楚这个问题有助于编写正确的代码，针对基本数据类型赋值，数据初始化只在栈区完成，简单理解A对B的赋值，其实是内存中会产生A的一个副本，然后和B的变量绑定到一起，结果就是A和B是两个独立的内存地址，两者值的变化互不干扰，来看看下面的例子：</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let num1 = <span class="number">123</span><span class="comment">;</span></span><br><span class="line">let num2 = num1<span class="comment">;</span></span><br><span class="line"><span class="attribute">num2</span> = <span class="number">345</span><span class="comment">;</span></span><br><span class="line">console.log(num1)<span class="comment">; // output 123</span></span><br><span class="line">console.log(num2)<span class="comment">;// output 345</span></span><br></pre></td></tr></table></figure>
<p>从测试结果来看，也是符合预期的，尽管将num1赋值给了num2，num2的改变并不会影响num1的值；</p>
<p>引用数据类型的结果和上面是一样的么？接下来我们看一下引用数据类型的变量赋值：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let obj1 = <span class="built_in">new</span> <span class="keyword">Object</span>();</span><br><span class="line">obj1.name = <span class="string">'obj1 value'</span>;</span><br><span class="line">let obj2 = obj1;</span><br><span class="line">obj1.name = <span class="string">'obj2 value'</span>;</span><br><span class="line">console.log(obj1.name); // output obj2.<span class="keyword">value</span></span><br><span class="line">console.log(obj2.name); // output obj2 <span class="keyword">value</span></span><br></pre></td></tr></table></figure>
<p>为什么obj2值的改变也会带动obj1值的变化呢？这是由于当把obj1赋值给obj2的时候，只是在栈空间内复制了一份指向堆空间的地址赋值给obj2，结果obj1和obj2的指针指向的是堆区中同一片区域，所以obj2的变化会改变obj1的值。</p>
<ol start="3">
<li>数据传递</li>
</ol>
<p>JS中所有函数的参数都是按值传递的，当把函数外部的值赋给函数内部参数时，类似于上面提到的值从一个变量赋值给另一个变量，意味着如果是基本数据类型，则会复制一份栈空间内的数据给函数内部用，两者隔离互不影响；如果是引用类型，则会复制一份栈空间内的堆空间地址给函数内部用，函数内部值的变化会影响函数外值的变化，从下面的测试结果来看也是符合这个结论的：</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//基本数据传递</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeValue</span>(<span class="params">num1</span>)</span>&#123;</span><br><span class="line">  num1 = <span class="number">345</span>;</span><br><span class="line">  <span class="keyword">return</span> num1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> num1 = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">let</span> num2 = changeValue(num1);</span><br><span class="line"><span class="built_in">console</span>.log(num1); <span class="comment">// output 123</span></span><br><span class="line"><span class="built_in">console</span>.log(num2); <span class="comment">// output 345</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//引用数据传递</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeName</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  obj.name = <span class="string">'obj2 value'</span>;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj1 = &#123;<span class="attr">name</span>:<span class="string">"obj1 value"</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> obj2 = changeName(obj1);</span><br><span class="line"><span class="built_in">console</span>.log(obj1.name); <span class="comment">// output 'obj2 value'</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2.name); <span class="comment">// output 'obj2 value'</span></span><br></pre></td></tr></table></figure>

<p>上述是从内存分配角度介绍了JS中的数据类型，核心在于基本数据类型和引用数据类型的存储方式不同会影响变量的操作，针对JS中常见数据类型的语法可以参考<a href="https://javascript.info/types" target="_blank" rel="noopener">官方文档</a>，接下来有必要聊一下JS中的Object对象；</p>
<h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><p>对象是JS中重要的概念，上一节已经提到Object是引用数据类型，相比较于其他基本数据类型（仅存储单一的值比如字符串、数字等），Object可以用来存储和操作复杂的数据，通过下面的语句先来创建一个对象：</p>
 <figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//<span class="keyword">Method</span> <span class="number">1</span> "object literal" syntax   支持一次创建一个对象</span><br><span class="line">let <span class="keyword">user</span> = &#123;&#125;;  </span><br><span class="line"></span><br><span class="line">//<span class="keyword">Method</span> <span class="number">2</span>  "object constructor" syntax  支持代码重用性</span><br><span class="line">let <span class="keyword">user</span> = <span class="built_in">new</span> <span class="keyword">Object</span>(); </span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="keyword">User</span>(<span class="type">name</span>) &#123;</span><br><span class="line">  this.name = <span class="type">name</span>;</span><br><span class="line">  this.isAdmin = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">let <span class="keyword">user</span> = <span class="built_in">new</span> <span class="keyword">User</span>("Jack");</span><br></pre></td></tr></table></figure>
<p>user可以理解为一个存储在栈区的指针，对应的值存储在堆区，值是包含多个属性的集合，每一个属性包含属性名称（key）和属性值(Value)，对于存储在堆区的数值可以理解为多组键值对（key-value pairs），其中key可以必须为字符串或者symbols，value可以是任意类型，接着给user添加一些属性：</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> user = &#123;     // an object</span><br><span class="line"> <span class="built_in"> name</span>: <span class="string">"John"</span>,  // <span class="keyword">by</span><span class="built_in"> key</span> <span class="string">"name"</span> store <span class="keyword">value</span> <span class="string">"John"</span></span><br><span class="line">  age: <span class="number">30</span>        // <span class="keyword">by</span><span class="built_in"> key</span> <span class="string">"age"</span> store <span class="keyword">value</span> <span class="number">30</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>我们可以通过<strong>objectname.propertyname</strong>或者<strong>objectname[“propertyname”]</strong>访问属性值，而且可以操作（增加、删除）对象属性，比如<em>delete user.name</em>将删除user中的name属性。</p>
<p>JS中Array、Date、Map、Function等类型都是Object，通过<em>instanceof</em>可以判断对象是否属于某个class:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Array</span></span><br><span class="line"><span class="keyword">let</span> myArray = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(myArray))  <span class="comment">// output :object</span></span><br><span class="line"><span class="built_in">console</span>.log(myArray <span class="keyword">instanceof</span> <span class="built_in">Array</span>) <span class="comment">// output: true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Map</span></span><br><span class="line"><span class="keyword">let</span> myMap = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">myMap.set(<span class="string">'1'</span>, <span class="string">'str1'</span>);   <span class="comment">// a string key</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(myMap)) <span class="comment">// output :object</span></span><br><span class="line"><span class="built_in">console</span>.log(myMap <span class="keyword">instanceof</span> <span class="built_in">Map</span>) <span class="comment">// output: true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Set</span></span><br><span class="line"><span class="keyword">let</span> mySet = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"><span class="keyword">let</span> john = &#123; <span class="attr">name</span>: <span class="string">"John"</span> &#125;;</span><br><span class="line">mySet.add(john);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(mySet));  <span class="comment">// output :object</span></span><br><span class="line"><span class="built_in">console</span>.log(mySet <span class="keyword">instanceof</span> <span class="built_in">Set</span>) <span class="comment">// output: true</span></span><br></pre></td></tr></table></figure>

<p><strong>之前我们提到JS是基于原型的，为什么这里出现Map、Set等Class?</strong><br>通过下面的例子来了解一下Class关键字:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Custom Class</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  printName() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">let</span> myAnimal = <span class="keyword">new</span> Animal</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> Animal);  <span class="comment">// Output: function</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> myAnimal);  <span class="comment">// Output: object</span></span><br><span class="line"><span class="built_in">console</span>.log(myAnimal <span class="keyword">instanceof</span> Animal) <span class="comment">// Output: true</span></span><br></pre></td></tr></table></figure>
<p>其中的<em>constructor</em>方法会被<strong>new</strong>关键字调用，通过上面的输出可以看到Animal的类型是function，其实当我们通过class申明时，以下两点需要了解：</p>
<ol>
<li>通过Class申明的Animal，内部其实是以function申明的方式实现（typeof Animal == function），<em>contructor</em>中的代码逻辑就是function的方法体：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Define the Animal by function keyword</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line">      </span><br><span class="line">Animal.prototype.printName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> duck = <span class="keyword">new</span> Animal(<span class="string">'duck'</span>);</span><br><span class="line">duck.printName();  <span class="comment">// Displays "duck"  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Define the Animal by class key word</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  printName() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> Animal);  <span class="comment">// Display "function"</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Class中的方法，其实就是Animal.prototype.method，意味着通过class关键字申明类与function申明的类，本质是没有区别的。</li>
</ol>
<p>使用Class关键字有什么好处呢？</p>
<ul>
<li>JS提供的语法糖，更符合传统后端开发者的习惯；</li>
<li>方便多级原型继承；</li>
</ul>
<p>通过Class申明的类，内部的变量属性和方法会自动绑定到原型中，可以轻松实现多级继承，提升开发效率，下面定义了一个<em>Cat</em>继承<em>Animal</em>的类：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    printName() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">    printName()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Cat:'</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dog = <span class="keyword">new</span> Animal(<span class="string">'anan'</span>);</span><br><span class="line">dog.printName(); <span class="comment">// Output ana</span></span><br><span class="line"><span class="built_in">console</span>.log(dog <span class="keyword">instanceof</span> Cat); <span class="comment">//Output false -  instanceof 会从原型链中找到指定对象的类型，返回true,否则返回false</span></span><br><span class="line"><span class="built_in">console</span>.log(dog <span class="keyword">instanceof</span> Animal); <span class="comment">//Output true</span></span><br><span class="line"><span class="keyword">let</span> cat = <span class="keyword">new</span> Cat(<span class="string">'fufu'</span>);</span><br><span class="line">cat.printName(); <span class="comment">//Output fufu</span></span><br><span class="line"><span class="built_in">console</span>.log(cat <span class="keyword">instanceof</span> Cat); <span class="comment">//Output true</span></span><br><span class="line"><span class="built_in">console</span>.log(cat <span class="keyword">instanceof</span> Animal);<span class="comment">//Output true</span></span><br></pre></td></tr></table></figure>

<p><strong>This关键字</strong> </p>
<p>this在JS中扮演着什么角色？发挥着什么作用？<br>this是一个对象的指针，<strong>这个地址的值由JS运行时决定的，取决于方法的调用者</strong>，下面的例子可以看到this会指向user，也会指向admin:</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">let <span class="keyword">user</span> = &#123; <span class="type">name</span>: "John" &#125;;</span><br><span class="line">let <span class="keyword">admin</span> = &#123; <span class="type">name</span>: "Admin" &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> sayHi() &#123;</span><br><span class="line">  console.log( this.name );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// use the same <span class="keyword">function</span> <span class="keyword">in</span> two objects</span><br><span class="line"><span class="keyword">user</span>.f = sayHi;</span><br><span class="line"><span class="keyword">admin</span>.f = sayHi;</span><br><span class="line"></span><br><span class="line">// these calls have different this</span><br><span class="line">// "this" inside the <span class="keyword">function</span> <span class="keyword">is</span> the <span class="keyword">object</span> "before the dot"</span><br><span class="line"><span class="keyword">user</span>.f(); // John  (this == <span class="keyword">user</span>)</span><br><span class="line"><span class="keyword">admin</span>.f(); // <span class="keyword">Admin</span>  (this == <span class="keyword">admin</span>)</span><br></pre></td></tr></table></figure>

<p>变量的定义申明决定了变量的可见范围，其中在变量的可见范围内，通过this可以访问到；this可能指向两个地址，首先会指向当前调用者的container object，如果没有显式的申明调用者，则会指向global project。</p>
<p>其中在浏览器端，global context指的是window object，this指的是window对象；在Node中，this会指向globalThis(global object)，</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="keyword">increment</span>(incrementBy)&#123;</span><br><span class="line">    this.aValue = this.aValue + incrementBy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//Demo <span class="number">1</span></span><br><span class="line">var thisPointToObject = &#123;</span><br><span class="line">    aValue: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">thisPointToObject.<span class="keyword">increment</span> = <span class="keyword">increment</span>;</span><br><span class="line">thisPointToObject.<span class="keyword">increment</span>(<span class="number">2</span>);//this <span class="type">point</span> <span class="keyword">to</span> <span class="keyword">current</span> obj</span><br><span class="line">console.log(thisPointToObject.aValue); // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">//Demo <span class="number">2</span></span><br><span class="line"><span class="keyword">global</span>.aValue = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">increment</span>(<span class="number">2</span>);//this <span class="type">point</span> <span class="keyword">to</span> <span class="keyword">global</span> project</span><br><span class="line">console.log(<span class="keyword">global</span>.aValue ); // <span class="number">8</span></span><br></pre></td></tr></table></figure>

<p><img src="thispointtoobject.png" alt="this keyword point to object"></p>
<p><img src="thispointtoproject.png" alt="this keyword point to global project"></p>
<h2 id="Events-amp-Function"><a href="#Events-amp-Function" class="headerlink" title="Events &amp; Function"></a>Events &amp; Function</h2><p>前面介绍了JS的数据类型包含基本数据类型和引用数据类型，再结合程序设计语言的三大基本结构（顺序结构、选择分支结构、循环结构），我们就可以编写复杂的业务程序，在此之前，有必要了解一下JS中的事件和函数，这两者是在浏览器端是相互依存，浏览器端事件的触发引起函数的调用，才能真正发挥JS的作用，下面三点是需要了解的：</p>
<ol>
<li><p>JS中的事件是由浏览器通知的<br>网页上按钮的点击、输入框的变化、光标的移动，都是由DOM组件发出的事件，这些事件会传递给JS引擎，调用对应的方法；</p>
</li>
<li><p>函数（Function）也是一个对象<br>正如之前提到的，function是JS中的头等函数，它们可以像基本数据类型一样进行赋值、作为函数参数以及作为函数返回参数。</p>
</li>
</ol>
<p>2.1. 方法申明</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Function Declaration</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Hello:'</span> + name</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Function Expression</span></span><br><span class="line"><span class="keyword">const</span> sayHello2 = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Hello:'</span> + name</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Arrow Function </span></span><br><span class="line"><span class="keyword">let</span> sayhello3 = <span class="function">(<span class="params">name</span>) =&gt;</span> <span class="string">'Hello:'</span> + name</span><br><span class="line"><span class="comment">// 方法调用</span></span><br><span class="line"><span class="keyword">let</span> sayHelloInvoker1 = sayHello(<span class="string">'Function Declaration'</span>);</span><br><span class="line"><span class="keyword">let</span> sayHelloInvoker2 = sayHello2(<span class="string">'Function Expression'</span>);</span><br><span class="line"><span class="keyword">let</span> sayHelloInvoker3 = sayHello2(<span class="string">'Arrow Function'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(sayHelloInvoker1);</span><br><span class="line"><span class="built_in">console</span>.log(sayHelloInvoker2);</span><br><span class="line"><span class="built_in">console</span>.log(sayHelloInvoker3);</span><br></pre></td></tr></table></figure>

<p>2.2. 方法调用</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//<span class="built_in"> invoke </span>function</span><br><span class="line">let invokeResult = sayHello('Invoke Function');</span><br><span class="line">console.log(invokeResult);</span><br><span class="line">// assign sayHello function to a<span class="built_in"> new </span>pointer</span><br><span class="line">const sayHelloNew = sayHello;</span><br><span class="line">let invokeResultNew = sayHelloNew('Invoke New Function');</span><br><span class="line">console.log(invokeResultNew);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>函数（Function）作为事件处理器</li>
</ol>
<p>3.1. 绑定HTML元素<br>在HTML中，指定事件调用的JS方法，如下面例子所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"handleClick(event)"</span>&gt;</span></span><br><span class="line">            Click me</span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> handleClick = <span class="function"><span class="keyword">function</span><span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(event.type);  <span class="comment">// click</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3.2. 调用DOM API<br>相比较于直接将JS方法绑定到HTML元素中，现在比较流行的方式是直接调用DOM对象的API，可以提升页面响应速度，提升用户体验，还是上面的例子，我们做出以下改变：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"clicker"</span>&gt;</span></span><br><span class="line">            Click me</span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span>        	</span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> handleClick = <span class="function"><span class="keyword">function</span><span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(event.type);  <span class="comment">//output click</span></span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> button = <span class="built_in">document</span>.getElementById(<span class="string">"clicker"</span>);</span></span><br><span class="line"><span class="actionscript">        button.addEventListener(<span class="string">"click"</span>, handleClick);</span></span><br><span class="line"><span class="actionscript">        <span class="comment">//anonymous functions </span></span></span><br><span class="line"><span class="actionscript">        button.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span><span class="params">(event)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(event.type);  <span class="comment">//output click</span></span></span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="异步特性"><a href="#异步特性" class="headerlink" title="异步特性"></a>异步特性</h2><p>当我们访问网站的时候，如果页面总是卡顿，总会降低用户访问网站的兴致，前端页面会包含很多JS脚本；<strong>JS是单线程的一门语言，意味着一个时间点只能处理一件事情</strong>，比如现在页面上一个按钮绑定了后台服务器方法，如果用户点击按钮后，需要等待服务器处理结果才能进行其他操作，这样的网站用户体验十分糟糕，针对这种情况，需要保证页面不会发生阻塞，现在有必要引入异步编程，咱们简单看一下JS是怎么处理的？</p>
<p>通过下面的<a href="http://latentflip.com/loupe/?code=c2V0VGltZW91dChmdW5jdGlvbigpewogIGNvbnNvbGUubG9nKCJUaGlzIGNvbWVzIGZpcnN0Iik7Cn0sIDUwMDApOwpjb25zb2xlLmxvZygiVGhpcyBjb21lcyBzZWNvbmQiKTsKCi8vb3V0cHV0IGluIGNvbnNvbGUKLy8gIlRoaXMgY29tZXMgc2Vjb25kIgovLyAiVGhpcyBjb21lcyBmaXJzdCI%3D!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D" target="_blank" rel="noopener">例子</a>来回顾一下JSRunning引擎的运行:</p>
<p><img src="JSRuntime.png" alt="JSEventLoop"></p>
<ul>
<li>一般情况下，JS引擎会依次顺序执行代码片段；</li>
<li>如果出现会导致浏览器阻塞的操作，比如请求后台服务器、获取数据库数据等耗时动作，JS引擎不会马上执行，而是将任务添加到<strong>Web API</strong>中，待异步操作完成后，将回调方法放入<strong>Callback Queue</strong>中；</li>
<li>尽管Callback Queue中有任务，JS引擎也不会立刻执行，只有当<strong>Stack</strong>中任务为空时，<strong>Event Loop</strong>会执行任务队列中的回调方法。</li>
</ul>
<p>下面这段简短的JS是怎么执行的呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"This comes first"</span>);</span><br><span class="line">&#125;, <span class="number">5000</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"This comes second"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//output in console</span></span><br><span class="line"><span class="comment">// "This comes second"</span></span><br><span class="line"><span class="comment">// "This comes first"</span></span><br></pre></td></tr></table></figure>

<ol>
<li>JS引擎识别到setTimeout为异步方法，会将该任务放到WebAPI中，如下图所示：</li>
</ol>
<p><img src="Process1.1.png" alt="Step 1.1"></p>
<p><img src="Process1.2.png" alt="Step 1.2"></p>
<ol start="2">
<li>在Web APIs执行异步任务的过程中，并不会阻碍JS引擎执行接下来的代码，可以看到Stack中加载了<em>console.log(“This comes second”)</em>的任务，并将其打印在控制台中；</li>
</ol>
<p><img src="Process2.1.png" alt="Step 2.1"></p>
<p><img src="Process2.2.png" alt="Step 2.2"></p>
<ol start="3">
<li>让我们继续等待异步执行完成</li>
</ol>
<p><img src="Process3.1.png" alt="Step 3.1"></p>
<p><img src="Process3.2.png" alt="Step 3.2"></p>
<p>当异步任务完成后，我们可以看到这个异步操作放入了Callback Queue中，接下来等待Event Loop将该操作放入Stack中，如下图所示：</p>
<p><img src="Process3.3.png" alt="Step 3.3"></p>
<p><img src="Process3.4.png" alt="Step 3.4"></p>
<p>当Stack、Web APIs、Callback Queue都为空时，这个时候我们可以认为JS引擎完成了上述代码的执行，注意当前我们将timer时间设置为5秒，即使设置为0秒，JS引擎也会将该操作放入到Web APIs中，输出结果也是一样的。</p>
<p>了解JS实现异步的基本原理后，我们可以看到JS中常见的回调函数（异步回调）其实是在Web APIs执行完异步任务后，Event Loop会将回调函数放入到Stack中执行，在代码编写中，当遇到异步编程时，这个模型更有助于理解JS的执行过程和书写更有效的代码。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>现如今，JS的发展速度越来越迅猛，在前后端领域都扮演了重要的角色，在我个人看来，有必要重新审视这门编程语言；感谢您的阅读，文中如有不足的地方，请大家更正，希望文中内容给您带来思考的同时，可以将其思考内容分享给大家。</p>
<p>最后也向您提一个问题：JS是一门弱类型语言，意味着申明变量时不需要指定特定数据类型，在解释执行阶段，JS解析器仍会在内存中分析得出具体数据类型；对于一些强类型语言（Java），需要在编写代码阶段明确对应数据类型，那么编程中数据类型的明确有什么意义呢？</p>
<p><strong>常用工具：</strong></p>
<ul>
<li><a href="http://jsbin.com" target="_blank" rel="noopener">JSBin</a></li>
<li><a href="https://codepen.io/" target="_blank" rel="noopener">Codepen</a></li>
<li><a href="http://latentflip.com/loupe/" target="_blank" rel="noopener">Loupe</a></li>
</ul>
<p><strong>参考资料：</strong></p>
<p>MDN:<br><a href="https://developer.mozilla.org/en-US/docs/Web" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web</a></p>
<p>Javascript Info:<br><a href="https://javascript.info/" target="_blank" rel="noopener">https://javascript.info/</a></p>
<p>Salesforce Modules:<br><a href="https://trailhead.salesforce.com/en/content/learn/trails/learn-to-work-with-javascript" target="_blank" rel="noopener">https://trailhead.salesforce.com/en/content/learn/trails/learn-to-work-with-javascript</a></p>
<p>ES6 Features:<br><a href="https://262.ecma-international.org/6.0/" target="_blank" rel="noopener">https://262.ecma-international.org/6.0/</a></p>
<p>ES6 Compatibility table:<br><a href="http://kangax.github.io/compat-table/es6/" target="_blank" rel="noopener">http://kangax.github.io/compat-table/es6/</a></p>


        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          
          <li class="next">
            <a href="/2020/05/05/Salesforce中SOAP的实践/" data-toggle="tooltip" data-placement="top" title="Salesforce中SOAP的实践">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <div class="tip">
          <p>
            If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
          </p>
        </div>
        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=浅谈JavaScript&body=Hi,I found this website and thought you might like it http://yoursite-url/2021/03/10/浅谈JavaScript/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->

<!-- gitalk start -->
<!-- Docs:https://github.com/gitalk/gitalk/blob/master/readme-cn.md -->

<div id="gitalk-container"></div>

<!-- <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.js"></script> -->
<script src="/js/comment/gitalk.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: '',
    owner: 'bubbali',
    admin: 'Bubba',
    id: 'Wed Mar 10 2021 00:00:00 GMT+0800', // Ensure uniqueness and length less than 50
    distractionFreeMode: false, // Facebook-like distraction free mode
    perPage: 10 ,
    pagerDirection: 'last',
    createIssueManually: false ,
    language: 'en'
  });
  gitalk.render('gitalk-container');

  var gtFolded = () => {
    setTimeout(function() {
      let markdownBody = document.getElementsByClassName("markdown-body");
      let list = Array.from(markdownBody);
      list.forEach(item => {
        if (item.clientHeight > 250) {
          item.classList.add('gt-comment-body-folded');
          item.style.maxHeight = '250px';
          item.title = 'Click to Expand';
          item.onclick = function() {
            item.classList.remove('gt-comment-body-folded');
            item.style.maxHeight = '';
            item.title = '';
            item.onclick = null;
          };
        }
      })
    }, 800);
  }
</script>

<!-- gitalk end -->



<!-- 2. gitment comment -->



<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#发展背景"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">发展背景</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#JavaScript语言特性"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">JavaScript语言特性</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#常用数据类型"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">常用数据类型</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Object"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">Object</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Events-amp-Function"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">Events &amp; Function</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#异步特性"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">异步特性</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#总结"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">总结</span></a></li></ol>
        
        </div>
      </aside>
    


      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#JS" title="JS">JS</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://v-vincen.life/" target="_blank">V_Vincen</a>
          </li>
          
          <li>
            <a href="http://beantech.org" target="_blank">Bean Tech</a>
          </li>
          
          <li>
            <a href="http://huangxuan.me" target="_blank">Hux Blog</a>
          </li>
          
          <li>
            <a href="https://hexo.io/" target="_blank">Hexo</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



	<!-- Footer (contains ThemeColor、viewer) -->
	<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          
            <li>
              <a target="_blank" href="https://github.com/bubbali">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          
            <li>
              <a target="_blank" href="https://www.linkedin.com/in/bubba-li-562862b3">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy;
          Bubba
          2021
          <br>
          Theme by
          <a href="http://beantech.org" target="_blank" rel="noopener">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a href="https://bubbali.github.io" target="_blank" rel="noopener">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=bubbali&repo=bubbali.github.io&type=star&count=true"></iframe>
        </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>

<!-- jQuery -->
<script type="text/javascript" src="/js/jquery.min.js"></script>
<!-- <script type="text/javascript" src="/js/jquery.js"></script> -->
<!-- <script type="text/javascript" src="//cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->

<!-- Bootstrap Core JavaScript -->
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script type="text/javascript" src="/js/hux-blog.min.js"></script>

<!-- catalog -->
<script type="text/javascript" async="true" src="/js/catalog.js?v=1.0.0"></script>

<!-- totop(rocket) -->
<script type="text/javascript" async="true" src="/js/totop.js?v=1.0.0"></script>

<!-- Busuanzi JavaScript -->
<script type="text/javascript" async="true" src="/js/busuanzi.pure.mini.js"></script>


  <!-- Scroll start -->
  <script type="text/javascript" src="/js/scroll.js"></script>
  <!-- Scroll end -->



  <!-- ThemeColor start -->
  <script type="text/javascript" src="/js/themecolor.js"></script>
  <!-- ThemeColor end -->





  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  <script type="text/javascript" src="/js/viewer/viewer.min.js"></script>
  <script type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){ hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if($('#tag_cloud').length !== 0){ async("http://yoursite-url/js/jquery.tagcloud.js",function(){ $.fn.tagcloud.defaults = { //size: {start: 1, end: 1, unit: 'em'}, color: {start:
'#bbbbee', end: '#0085a1'}, }; $('#tag_cloud a').tagcloud(); }) } </script> -->


	<!-- Search -->
	
	<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/ziploader.js"></script>
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;

            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


	

	<!-- Image to hack wechat -->
	<!-- <img src="http://yoursite-url/img/icon_wechat.png" width="0" height="0" /> -->
	<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
